//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by the Rock.CodeGeneration project
//     Changes to this file will be lost when the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------
// <copyright>
// Copyright by the Spark Development Network
//
// Licensed under the Rock Community License (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
//
// http://www.rockrms.com/license
//
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.
// </copyright>
//

using System;
using System.Linq;
using Rock.Attribute;
using Rock.Model;
using Rock.Web.Cache;

namespace Rock.ViewModel
{
    /// <summary>
    /// WorkflowActionForm View Model
    /// </summary>
    [ViewModelOf( typeof( Rock.Model.WorkflowActionForm ) )]
    public partial class WorkflowActionFormViewModel : ViewModelBase
    {
        /// <summary>
        /// Gets or sets the ActionAttributeGuid.
        /// </summary>
        /// <value>
        /// The ActionAttributeGuid.
        /// </value>
        public Guid? ActionAttributeGuid { get; set; }

        /// <summary>
        /// Gets or sets the Actions.
        /// </summary>
        /// <value>
        /// The Actions.
        /// </value>
        public string Actions { get; set; }

        /// <summary>
        /// Gets or sets the AllowNotes.
        /// </summary>
        /// <value>
        /// The AllowNotes.
        /// </value>
        public bool? AllowNotes { get; set; }

        /// <summary>
        /// Gets or sets the AllowPersonEntry.
        /// </summary>
        /// <value>
        /// The AllowPersonEntry.
        /// </value>
        public bool AllowPersonEntry { get; set; }

        /// <summary>
        /// Gets or sets the Footer.
        /// </summary>
        /// <value>
        /// The Footer.
        /// </value>
        public string Footer { get; set; }

        /// <summary>
        /// Gets or sets the Header.
        /// </summary>
        /// <value>
        /// The Header.
        /// </value>
        public string Header { get; set; }

        /// <summary>
        /// Gets or sets the IncludeActionsInNotification.
        /// </summary>
        /// <value>
        /// The IncludeActionsInNotification.
        /// </value>
        public bool IncludeActionsInNotification { get; set; }

        /// <summary>
        /// Gets or sets the NotificationSystemCommunicationId.
        /// </summary>
        /// <value>
        /// The NotificationSystemCommunicationId.
        /// </value>
        public int? NotificationSystemCommunicationId { get; set; }

        /// <summary>
        /// Gets or sets the PersonEntryAddressEntryOption.
        /// </summary>
        /// <value>
        /// The PersonEntryAddressEntryOption.
        /// </value>
        public int PersonEntryAddressEntryOption { get; set; }

        /// <summary>
        /// Gets or sets the PersonEntryAutofillCurrentPerson.
        /// </summary>
        /// <value>
        /// The PersonEntryAutofillCurrentPerson.
        /// </value>
        public bool PersonEntryAutofillCurrentPerson { get; set; }

        /// <summary>
        /// Gets or sets the PersonEntryBirthdateEntryOption.
        /// </summary>
        /// <value>
        /// The PersonEntryBirthdateEntryOption.
        /// </value>
        public int PersonEntryBirthdateEntryOption { get; set; }

        /// <summary>
        /// Gets or sets the PersonEntryCampusIsVisible.
        /// </summary>
        /// <value>
        /// The PersonEntryCampusIsVisible.
        /// </value>
        public bool PersonEntryCampusIsVisible { get; set; }

        /// <summary>
        /// Gets or sets the PersonEntryConnectionStatusValueId.
        /// </summary>
        /// <value>
        /// The PersonEntryConnectionStatusValueId.
        /// </value>
        public int? PersonEntryConnectionStatusValueId { get; set; }

        /// <summary>
        /// Gets or sets the PersonEntryEmailEntryOption.
        /// </summary>
        /// <value>
        /// The PersonEntryEmailEntryOption.
        /// </value>
        public int PersonEntryEmailEntryOption { get; set; }

        /// <summary>
        /// Gets or sets the PersonEntryFamilyAttributeGuid.
        /// </summary>
        /// <value>
        /// The PersonEntryFamilyAttributeGuid.
        /// </value>
        public Guid? PersonEntryFamilyAttributeGuid { get; set; }

        /// <summary>
        /// Gets or sets the PersonEntryGenderEntryOption.
        /// </summary>
        /// <value>
        /// The PersonEntryGenderEntryOption.
        /// </value>
        public int PersonEntryGenderEntryOption { get; set; }

        /// <summary>
        /// Gets or sets the PersonEntryGroupLocationTypeValueId.
        /// </summary>
        /// <value>
        /// The PersonEntryGroupLocationTypeValueId.
        /// </value>
        public int? PersonEntryGroupLocationTypeValueId { get; set; }

        /// <summary>
        /// Gets or sets the PersonEntryHideIfCurrentPersonKnown.
        /// </summary>
        /// <value>
        /// The PersonEntryHideIfCurrentPersonKnown.
        /// </value>
        public bool PersonEntryHideIfCurrentPersonKnown { get; set; }

        /// <summary>
        /// Gets or sets the PersonEntryMaritalStatusEntryOption.
        /// </summary>
        /// <value>
        /// The PersonEntryMaritalStatusEntryOption.
        /// </value>
        public int PersonEntryMaritalStatusEntryOption { get; set; }

        /// <summary>
        /// Gets or sets the PersonEntryMobilePhoneEntryOption.
        /// </summary>
        /// <value>
        /// The PersonEntryMobilePhoneEntryOption.
        /// </value>
        public int PersonEntryMobilePhoneEntryOption { get; set; }

        /// <summary>
        /// Gets or sets the PersonEntryPersonAttributeGuid.
        /// </summary>
        /// <value>
        /// The PersonEntryPersonAttributeGuid.
        /// </value>
        public Guid? PersonEntryPersonAttributeGuid { get; set; }

        /// <summary>
        /// Gets or sets the PersonEntryPostHtml.
        /// </summary>
        /// <value>
        /// The PersonEntryPostHtml.
        /// </value>
        public string PersonEntryPostHtml { get; set; }

        /// <summary>
        /// Gets or sets the PersonEntryPreHtml.
        /// </summary>
        /// <value>
        /// The PersonEntryPreHtml.
        /// </value>
        public string PersonEntryPreHtml { get; set; }

        /// <summary>
        /// Gets or sets the PersonEntryRecordStatusValueId.
        /// </summary>
        /// <value>
        /// The PersonEntryRecordStatusValueId.
        /// </value>
        public int? PersonEntryRecordStatusValueId { get; set; }

        /// <summary>
        /// Gets or sets the PersonEntrySpouseAttributeGuid.
        /// </summary>
        /// <value>
        /// The PersonEntrySpouseAttributeGuid.
        /// </value>
        public Guid? PersonEntrySpouseAttributeGuid { get; set; }

        /// <summary>
        /// Gets or sets the PersonEntrySpouseEntryOption.
        /// </summary>
        /// <value>
        /// The PersonEntrySpouseEntryOption.
        /// </value>
        public int PersonEntrySpouseEntryOption { get; set; }

        /// <summary>
        /// Gets or sets the PersonEntrySpouseLabel.
        /// </summary>
        /// <value>
        /// The PersonEntrySpouseLabel.
        /// </value>
        public string PersonEntrySpouseLabel { get; set; }

        /// <summary>
        /// Gets or sets the CreatedDateTime.
        /// </summary>
        /// <value>
        /// The CreatedDateTime.
        /// </value>
        public DateTime? CreatedDateTime { get; set; }

        /// <summary>
        /// Gets or sets the ModifiedDateTime.
        /// </summary>
        /// <value>
        /// The ModifiedDateTime.
        /// </value>
        public DateTime? ModifiedDateTime { get; set; }

        /// <summary>
        /// Gets or sets the CreatedByPersonAliasId.
        /// </summary>
        /// <value>
        /// The CreatedByPersonAliasId.
        /// </value>
        public int? CreatedByPersonAliasId { get; set; }

        /// <summary>
        /// Gets or sets the ModifiedByPersonAliasId.
        /// </summary>
        /// <value>
        /// The ModifiedByPersonAliasId.
        /// </value>
        public int? ModifiedByPersonAliasId { get; set; }

        /// <summary>
        /// Sets the properties from.
        /// </summary>
        /// <param name="model">The model.</param>
        /// <param name="currentPerson">The current person.</param>
        /// <param name="loadAttributes">if set to <c>true</c> [load attributes].</param>
        public virtual void SetPropertiesFrom( Rock.Model.WorkflowActionForm model, Person currentPerson = null, bool loadAttributes = true )
        {
            if ( model == null )
            {
                return;
            }

            if ( loadAttributes && model is IHasAttributes hasAttributes )
            {
                if ( hasAttributes.Attributes == null )
                {
                    hasAttributes.LoadAttributes();
                }

                Attributes = hasAttributes.AttributeValues.Where( av =>
                {
                    var attribute = AttributeCache.Get( av.Value.AttributeId );
                    return attribute?.IsAuthorized( Rock.Security.Authorization.EDIT, currentPerson ) ?? false;
                } ).ToDictionary(
                    kvp => kvp.Key,
                    kvp => kvp.Value.ToViewModel<AttributeValueViewModel>() as object );
            }

            ActionAttributeGuid = model.ActionAttributeGuid;
            Actions = model.Actions;
            AllowNotes = model.AllowNotes;
            AllowPersonEntry = model.AllowPersonEntry;
            Footer = model.Footer;
            Header = model.Header;
            IncludeActionsInNotification = model.IncludeActionsInNotification;
            NotificationSystemCommunicationId = model.NotificationSystemCommunicationId;
            PersonEntryAddressEntryOption = ( int ) model.PersonEntryAddressEntryOption;
            PersonEntryAutofillCurrentPerson = model.PersonEntryAutofillCurrentPerson;
            PersonEntryBirthdateEntryOption = ( int ) model.PersonEntryBirthdateEntryOption;
            PersonEntryCampusIsVisible = model.PersonEntryCampusIsVisible;
            PersonEntryConnectionStatusValueId = model.PersonEntryConnectionStatusValueId;
            PersonEntryEmailEntryOption = ( int ) model.PersonEntryEmailEntryOption;
            PersonEntryFamilyAttributeGuid = model.PersonEntryFamilyAttributeGuid;
            PersonEntryGenderEntryOption = ( int ) model.PersonEntryGenderEntryOption;
            PersonEntryGroupLocationTypeValueId = model.PersonEntryGroupLocationTypeValueId;
            PersonEntryHideIfCurrentPersonKnown = model.PersonEntryHideIfCurrentPersonKnown;
            PersonEntryMaritalStatusEntryOption = ( int ) model.PersonEntryMaritalStatusEntryOption;
            PersonEntryMobilePhoneEntryOption = ( int ) model.PersonEntryMobilePhoneEntryOption;
            PersonEntryPersonAttributeGuid = model.PersonEntryPersonAttributeGuid;
            PersonEntryPostHtml = model.PersonEntryPostHtml;
            PersonEntryPreHtml = model.PersonEntryPreHtml;
            PersonEntryRecordStatusValueId = model.PersonEntryRecordStatusValueId;
            PersonEntrySpouseAttributeGuid = model.PersonEntrySpouseAttributeGuid;
            PersonEntrySpouseEntryOption = ( int ) model.PersonEntrySpouseEntryOption;
            PersonEntrySpouseLabel = model.PersonEntrySpouseLabel;
            CreatedDateTime = model.CreatedDateTime;
            ModifiedDateTime = model.ModifiedDateTime;
            CreatedByPersonAliasId = model.CreatedByPersonAliasId;
            ModifiedByPersonAliasId = model.ModifiedByPersonAliasId;

            SetAdditionalPropertiesFrom( model, currentPerson, loadAttributes );
        }

        /// <summary>
        /// Creates a view model from the specified model.
        /// </summary>
        /// <param name="model">The model.</param>
        /// <param name="currentPerson" >The current person.</param>
        /// <param name="loadAttributes" >if set to <c>true</c> [load attributes].</param>
        /// <returns></returns>
        public static WorkflowActionFormViewModel From( Rock.Model.WorkflowActionForm model, Person currentPerson = null, bool loadAttributes = true )
        {
            var viewModel = new WorkflowActionFormViewModel();
            viewModel.SetPropertiesFrom( model, currentPerson, loadAttributes );
            return viewModel;
        }
    }
}
